# 네트워킹: (교차) 컨테이너 통신

## 모듈 소개

## case 1: WWW 통신 컨테이너
컨테이너에서 실행되는 어플리케이션에서 웹 API로 HTTP Request를 보내는 방법 설명
- 일반적인 API 통신과 동일
## case 2: 컨테이너에서 로컬 호스트 머신으로의 통신
- 호스트머신 / DB 등과 도커화된 앱 내부에서 통신 원하는 상황 발생시 이에 대한 주소를 적음
## case 3: 컨테이너 간 통신
- 컨테이너 내에서 실행 중인 어플리케이션이 다른 컨테이너와 통신하길 원하는 경우 아이피를 적
## 데모 앱 분석하기

## 컨테이너 만들기 & 웹 통신하기(WWW)
```
docker run --name favorites -d -rm -p 3000:3000 favorites-node
```
- d : 분리된 모드
- rm : 실행후 삭제

기본적으로 컨테이너는 월드 와이드 웹에 요청을 보낼 수 있음

도커화된 애플리케이션 내부에서 웹 API 및 웹 페이지와 통신 가능

## 호스트 통신 작업을 위한 컨테이너 만들기
도커화된 어플리케이션에서 다른 로컬 호스트 머신과의 통신으로 변경을 원할 때 도커화된 컨테이너의 코드의 일부분만 변경하면 됨 

```docker
localhost -> host.docker.internal
```

- 도커가 이해할 수 있는 도메인
- 도커 컨테이너 내부에서 알 수 있는 호스트 머신의 IP 주소로 변환되고 이는 컨테이너와 호스트 머신 간의 통신을 보장
- 변경 후 이미지 리빌드 필요
## 컨테이너 간 통신: 기본 솔루션
컨테이너는 하나에만 집중하는 것이 낫다

```docker
docker run mongo
```

- 도커 파일 작성 필요 없이 mongo DB 공식 이미지를 실행

```docker
docker container inspect {name}
```

- NetworkSettings > IPAddress
    - 컨테이너의 IP 주소
    - 이 컨테이너에 연결 가능
- default port : 27017

⇒ 접속하는 컨테이너의 IP가 변경될 떄 마다 코드 수정후 새 이미지를 빌드해야 하는데 이를 해소 할 수 있는 방안이 없을까?
## Docker Networks 소개: 우아한 컨테이너 간 통신
**컨터이너 네트워크(=네트워크)**

다중 컨테이너 간의 통신을 허용하는 것 

```docker
docker run --network {네트워크 이름}
```

- 모든 컨테이너를 하나의 동일한 네트워크에 밀어 넣을 수 있음
    - 플래그 설정 : `--network`
- 컨테이너 IP 조회 및 해결 작업을 자동으로 수행
- 실행시 중지된 컨테이너 제거 후 실행 필요
- 도커는 네트워크를 자동으로 생성하지 않음으로 직접 만들어야 함
    
    ```docker
    docker networkd create {네트워크 이름}
    # my_network 와 같이 생성한 네트워크 뿐만 아니라 내장 네트워크 확인 가능 
    docker networkd ls 
    ```
    
- 두개의 컨테이너가 동일한 네트워크의 일부분인 경우 애플리케이션의 코드에 IP 하드코딩 하는 대신 
`컨테이너의 이름`을 입력하면 됨
    - 도커에 의해 컨테이너의 IP 주소로 변환됨
- ✅ 네트워크 설정시 컨테이너에 연결하기 위해 실행될때 포트 게시(publish) 안해줘도 됨
## Docker가 IP 주소를 해결하는 방법
✅ 도커는 코드를 읽고 내부적으로 교체하는 것이 아님

컨테이너의 이름을 보고, 코드에 플러그인된 컨테이너의 IP 주소를 연결함 

도커가 애플리케이션이 실행되는 환경을 소유하고 `애플리케이션이 요청을 전송하는 경우` 도커가 이를 인식

- 이 시점에서 주소, 컨테이너 이름, host.docker.internal 을 실제 `IP 주소로 변환`
- 주변의 컨테이너와 호스트 머신을 앎으로써 가능
## Docker Container Communication & Networks

## Docker 네트워크 드라이버
`bridge 드라이버`

- default
- 컨테이너가 동일한 네트워크에 있는 경우 이름으로 서로를 찾을 수 있음

대체 드라이버도 지원하지만 대부분 default 사용
## 모듈 요약

## 모듈 리소스

# Docker로 다중 컨테이너 애플리케이션 구축하기

## 모듈 소개

## Target 앱 & 설정

## MongoDB 서비스 도커화 하기

## Node 앱 도커화 하기

## React SPA를 컨테이너로 옮기기

## 효율적인 컨테이너 간 통신을 위한 Docker 네트워크 추가하기

## 몽고DB 인증 오류 해결하기(다음 강의와 관련)

## 볼륨으로 MongoDB에 데이터 지속성 추가하기

## NodeJS 컨테이너의 볼륨, 바인딩 마운트 및 폴리싱(Polishing)

## (바인드 마운트로) React 컨테이너에 대한 라이브 소스 코드 업데이트하기

## 모듈 요약

## 모듈 리소스
